# 요식업 자영업자를 위한 채팅 기반 고객 소통 보조 모델
### (코드스테이츠 딥러닝 섹션 개인 프로젝트)
- 진행 기간: 7월 23일 ~ 7월 26일
- 사용 언어: `Python`
- **프로젝트 발표 영상**은 [여기](https://youtu.be/81YjWzQoBRk)에서 보실 수 있습니다.
- 아래 내용은 프로젝트에 대한 요약 소개 버전으로, 좀더 상세한 프로젝트 진행 내용은 [노션 페이지](https://inhwan-hwang.notion.site/Transformer-c9f48d8ca85c401d8324fa872fae7938)에서 읽으실 수 있습니다.

---

<br>

## **프로젝트 개요**

Transformer를 활용하여, 요식업 자영업자를 위한 **채팅 기반 고객 소통 보조 모델**을 만드는 프로젝트입니다.

> 👉🏻  *요식업 자영엽자가 채팅으로 고객의 문의/요청을 받을 시, 답변 내용이 자동완성되어 효율적인 고객 소통이 이루어지도록 도와주는 딥러닝 보조 모델 기능 개발.*
> 
> - 기존 배달 플랫폼 시스템에 종속되어 생존의 문제를 겪고 있는 요식업 자영업자의  문제를 인식하고, 대안으로 새로운 채팅 기반 고객 소통 플랫폼을 제안하였습니다.
> - 해당 플랫폼 이용시 바쁜 자영업자가 직접 모든 답변을 작성하고 있을 여유가 없을 것이라 가정하고, 이 문제를 해결하기 위해 NLP 기술 활용에 주목하였습니다.
> - [소상공인 고객 주문 질의-응답 텍스트](https://aihub.or.kr/aihubdata/data/view.do?currMenu=115&topMenu=100&aihubDataSe=realm&dataSetSn=102)의 기존 고객 상담 데이터를 활용하여, 고객이 텍스트로 문의/요청을 하면 가장 관련도가 높은 답변이 출력되는 Transformer 모델 파이프라인을 구축하였습니다.
> - 모델 성능에 대해서는 Human Evaluation(직접 평가)를 하였습니다.
> 
> ---
> 

이번에는 자영업자를 대상으로 잡고 진행했지만, **채팅 기반 고객 상담이 이루어지는 많은 분야에 확장**하여 사용될 잠재성이 있다는 점에서도 의미가 있다고 생각합니다. 

<br>

## **문제 정의 및 가설**

**[문제 정의]**

- 최근 몇 년 사이 팬데믹으로 인해 배달 시장이 폭발적으로 성장하며 배달의민족/요기요 등 배달 플랫폼 또한 그 수혜를 톡톡히 보았습니다. 하지만 플랫폼의 한 축을 맡고 있는 요식업 자영업자의 현실은 달랐습니다.
- 다양한 기사들에서, 보다 직접적으로는 자영업자들이 가장 많이 모여있는 네이버 카페 `아프니까 사장이다`에서도 많은 분들이 현재의 배달 플랫폼에 종속되어 오는 문제에 대해, 이를 ‘생존의 문제’로 생각하고 있다는 걸 알 수 있었습니다. 하지만 이를 해결할 뚜렷한 대안은 없는 상황입니다.
![survey](https://user-images.githubusercontent.com/81467922/184390429-8151273b-93ad-45b8-9cdb-2879e5231a8c.png)<br>
- 이런 문제를 해결하기 위해 하나의 대안으로 “기존 배달 플랫폼을 거칠 필요 없이, 자영업자들이 고객과 직접 소통할 수 있는 소통 플랫폼이 있다면 어떨까?” 라는 생각을 해보게 되었습니다. 아래 이미지는 제가 생각한 비즈니스 모델의 요약입니다. 
<img width="472" alt="bm" src="https://user-images.githubusercontent.com/81467922/184391033-13ca2113-df10-4d6a-afbf-3239da1ee261.png"><br>

    (굳이 채팅 기반 플랫폼을 생각한 이유는 배달앱을 쓰기 싫어도 ‘전화 공포증(Call Phobia)’ 때문에 쓴다는 고객이 젊은 층을 위주로 많아지고 있기 때문입니다.)
    

**[가설]**

위 플랫폼을 구축한다고 생각했을 때 제가 세운 가설은 아래와 같습니다.

1. **요식업 자영업자들은 다양한 일을 동시에 하며 매우 바쁘기 때문에 채팅으로 모든 답변을 직접 다 치는 것이 부담될 것이다.**
2. ****고객으로부터 받는 대화의 종류가 어느 정도 정해져 있을 것이다.**** (ex. 메뉴 문의, 배달 주문)

채팅 기반 소통이 고객은 만족할 수 있어도 자영업자에게는 매우 부담스런 옵션이 될 것이라 가정하였습니다. 

- 만약 위 두 가지 가설이 맞다면, **고객 소통의 보조 도구로써 NLP 기술 접목할 수 있지 않을까? 라는 아이디어로부터 이번 프로젝트는 시작하였습니다.**
    - 참고 - 기능이 완전히 구현되었을 때 예시.
        - 고객이 채팅으로 배달/주문/메뉴 등에 관한 질문을 주면, 점원의 입력창에는 NLP 모델 기반으로 예상 답변이 입력되어있고, 점원은 확인 후 엔터만 누르면 됨.
        
<br>

## **사용한 데이터셋**

**[필요한 데이터셋]**

- 고객이 텍스트로 질문을 하면 그와 가장 관련있는 답변을 출력하는 NLP 모델을 만들기 위해 필요한 데이터셋은 ‘고객-점원의 질의응답 텍스트’라고 생각하고 관련 오픈 데이터를 탐색하였습니다.
    - 이런 유형의 데이터는 특성 상 스크래이핑할 인터넷 상 공간도 없고, 프로젝트 데드라인 내에 직접 수집하는 것에도 한계가 있기 때문에 오픈 데이터 탐색을 결정하였습니다.

**[선정한 데이터셋]**

- **AI Hub의 [소상공인 고객 주문 질의-응답 텍스트](https://aihub.or.kr/aihubdata/data/view.do?currMenu=115&topMenu=100&aihubDataSe=realm&dataSetSn=102)를 모델 학습 데이터로 선정하였습니다.**    
- **많은 업종 중 이번 프로젝트에서는 `카페` 업종을 선택하였는데, 이유는 아래와 같습니다.**
    1. 업종 특성 상 응대직원이 상시적으로 음료 제조에 투입되므로, NLP 자동완성 기술에 대한 니즈가 높을 것으로 예상됨.
    2. 판매 상품의 종류 및 고객 요청사항이 비교적 정형화되어 있고 대화가 짧아 모델의 일반화에 더 유리하다고 판단됨.
 
<br>

## 프로젝트 수행 과정 요약
<img width="1048" alt="summary" src="https://user-images.githubusercontent.com/81467922/184392117-f93a0688-d732-47a2-a929-d1da4f832f7b.png">

<br>

## **데이터 전처리**

**[데이터 전처리의 목표]**
- 질문이 입력되면 기존 고객 상담 데이터에 기반하여 관련도가 가장 높은 답변을 출력하는 것이 구축하려는 모델의 핵심 프레임워크입니다.
- 따라서 **’질문-답변’이 매칭된 데이터 형태**를 만들어 모델에 학습시키는 것이 필요했고, 이를 데이터 전처리의 목표로 설정하였습니다.

**[문제 사항]**
- 질문과 그에 맞는 답변을 매칭하여 `Q-A` 형태로 저장하기 위해 아래와 같이 **질문과 답변을 연속된 행에 위치시키고 `for loop` 를 통해 질문 하나, 답변 하나를 추출해 매칭하는 방식**을 생각하였으나, 많은 케이스에서 질문과 답변이 일정한 규칙없이 혼재되어 있는 노이즈가 발견되었습니다.
    - 질문에 대한 답변이 아예 존재하지 않는 경우가 있음.
    - 같은 대화에서 질문은 여러 행으로 나뉘어있고 답변은 한 번만 이루어진 경우가 있음.
- 행 정렬 후 `Q-A`를 매칭하려는 본래 의도를 생각했을 때, 중간에 한 번의 노이즈만 발생해도 이후의 모든 `Q-A`가 하나씩 밀려나 엉뚱하게 매칭되어 최악의 결과가 발생하는 문제를 해결해야만 했습니다.

**[해결 방법]**
- 다양한 방법을 시도해본 후 모든 데이터셋을 살리는 것은 어려울 것 같으며, **규칙이 확실한 데이터**만 건져서 데이터 수를 보고 이후 진행을 결정하기로 하였습니다.
- 여기서 **규칙이 확실한 데이터**로는 **질문과 답변이 딱 한번씩만 오고간 대화내역**을 잡았습니다.
    - **즉, `상담번호` 를 기준으로 질문과 답변이 각각 1개 행씩만 존재한다면, 이를 정렬하여 `Q-A` 를 매칭하는데 문제가 없을 것이라고 판단하였습니다.**
    - **그리고 실제로 전처리를 해본 결과 원하는 데이터 형태를 충분한 양으로 얻을 수 있었습니다.** (총 56,163건의 샘플 확보 성공.)

<br>

## **모델링**

**[프레임워크 개요]**
<img width="1049" alt="framework" src="https://user-images.githubusercontent.com/81467922/184393448-02386a2a-3cdc-4bb2-8bc7-b611a57b5d3c.png">


**Transformer 모델을 선택한 이유**

- 구현 기능의 주요 목표는 고객의 질문을 정확히 이해하고 그에 맞는 답변을 내주는 것인데, 트랜스포머는 Attention 매커니즘이 극대화되어 있어 자연어 처리 분야에서 매우 우수한 성능을 보이는 모델이다.
- GPU 연산에 최적화되어 있어 빠른 학습이 가능한 장점이 있는데,이는 추후 추가학습 등 확장성 측면에서유리하다.

**[진행 과정]**

1. 데이터 인코딩 (Subword TextEncoder)
2. 모델 구축 및 학습
    - 모델은 가장 기본적인 형태의 트랜스포머로 구축하였습니다.

<br>
   
## **모델 평가**

**[모델의 평가 - Human Evaluation (직접 평가)]**

- 직접 평가를 진행한 이유
    - BLEU 스코어 등 객관적인 지표를 사용해 모델을 평가해보기에는 프로젝트 데드라인이 촉박하였다.
    - 고객 상담의 특성 상 완전 개인적인 상담에 대해서는 사람의 리소스 직접 투입이 불가피하다.
        - 즉 고객 소통 보조 도구로써의 해당 모델의 효용은 우선 기초적인 질문/요청 등의 기본 응대에 대해 잘 작동하는 것에서부터 시작하기 때문에, 이에 대해 직접 출력을 확인해보며 어색한 점이 있는지 확인하는 것으로도 이번 프로젝트에서 충분히 의미가 있을 것으로 판단하였다.

**[결과]** <br>
<img width="613" alt="res" src="https://user-images.githubusercontent.com/81467922/184394016-ece8a053-ab75-4537-b121-efe89723197f.png">
- **다양한 질문을 넣어 테스트해본 결과, 일부 어색한 출력이 보이기는 하나 앞서 말씀드린 기본 응대는 충분히 가능해보이는 것으로 판단하였습니다.**
    
<br>
   
## **한계점 및 향후 목표**
1. **서비스 측면**
    - 고객 소통 보조 챗봇의 전체 기능 중 극히 초입인 모델 구현에만 그쳤다는 점. (실제 활용성 미검증) 
    - 간단하게라도 모델을 활용해 ‘질문-응답’이 이루어지는 APP을 구축해 사용성 테스트를 해보자.
2. **데이터 측면**
    - 다양한 업종으로 확장하기 어렵다는 점. (ex. 같은 질문이어도 고객에 따라 다른 답변이 나가는 패션 업종)
    - 데이터 전처리 시 이런 특성을 가진 질문에 대해선 적절한 처리가 이루어질 수 있도록 시도해보자.
3. **구현 모델 측면**
    - 다양한 성능 지표를 통한 모델의 객관적 지표 평가가 이루어지지 않았다는 점.
    - 성능 지표를 활용한 평가도 해본 후 출력값의 정확도를 높이기 위한 최적화 작업을 진행해보자.

<br>

## **프로젝트 회고**

- 이번 프로젝트를 완료한 직후 작성한 회고 글은 아래에서 읽어보실 수 있습니다.

[220723-0726 딥러닝 개인 프로젝트 회고](https://velog.io/@cualquier/220723-0726-%EB%94%A5%EB%9F%AC%EB%8B%9D-%EA%B0%9C%EC%9D%B8-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%ED%9A%8C%EA%B3%A0)
